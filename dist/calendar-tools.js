var t={d:(e,n)=>{for(var s in n)t.o(n,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:n[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function n(t,e,n,s,r){if(!t)return null;const i=document.createElement(t);return e&&(i.className=e),n&&(i.innerHTML=n),s&&(i.style.color=s),r&&(i.onclick=r),i}t.d(e,{Vv:()=>l,LR:()=>o,p3:()=>u,Ay:()=>g});const s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],r=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],i=["January","February","March","April","May","June","July","August","September","October","November","December"],a=[31,28,31,30,31,30,31,31,30,31,30,31];class l{constructor(t){this.data=t.data||null,this.events=t.events||[],this.data&&function(t){const e=t.data;if(!e)return;const n=[],s=e.split("\n");let r=null,i=!1;for(let t=0;t<s.length;t++){const e=s[t];e.startsWith("BEGIN:VEVENT")?(r="",i=!0):e.startsWith("END:VEVENT")?(n.push(new o({data:r})),r=null,i=!1):i&&(r+=e+"\n")}t.events=n}(this)}getEventsForDay(t,e){if(e||(e=this.events),!e||0==!e.length)return[];const n=[];for(let s=0;s<e.length;s++){const r=e[s];c(t,r)&&n.push(r)}return n}toIcal(){return function(t){const e=t.events;let n="BEGIN:VCALENDAR\n";n+="VERSION:2.0\n",n+="PRODID:-//EZ Office//NONSGML v1.0//EN\n",n+="CALSCALE:GREGORIAN\n";for(let t=0;t<e.length;t++)n+=h(e[t]);return n+="END:VCALENDAR\n",n}(this)}toHTML(t){return function(t,e){const l=new Date,o=t.year||l.getFullYear(),u=t.month||l.getMonth(),c=t.monthLabels||i;let d=new Date(o,u,1).getDay();t.startMonday&&(d--,d<0&&(d=6));let h=a[u];1==u&&(o%4==0&&o%100!=0||o%400==0)&&(h=29);const g=n("div","calendar");let f="";if(t.noStyle||(g.style.display="grid",g.style.gridTemplateColumns="repeat(7, 1fr)"),!t.noTitle){const e=n("div","calendar-title");e.innerHTML=c[u]+" "+o,t.noStyle||(e.style.gridColumn="1 / span 7"),g.appendChild(e),f+="auto "}if(!t.noDayLabels){const e=t.startMonday?r:s;for(let t=0;t<e.length;t++){let s="";0!=t&&6!=t||(s=" calendar-day-label-weekend");const r=n("div","calendar-day-label"+s);r.innerHTML=e[t],g.appendChild(r)}f+="auto "}let y=!0,T="",m=!0,E=!0;for(;m;){T=y?" calendar-week-even":" calendar-week-odd",y=!y;for(let s=0;s<7;s++){let r="";if(r=0==s||6==s?" calendar-day-weekend":" calendar-day-weekday",1>h)m=!1,g.appendChild(n("div","calendar-date-empty"+T+r));else if(E&&s<d)g.appendChild(n("div","calendar-date-empty"+T+r));else{const s=n("div","calendar-date"+T+r);if(1==l.getDate()&&u==l.getMonth()&&o==l.getFullYear()&&s.classList.add("calendar-date-today"),!t.noDateLabels){const t=n("div","calendar-date-label");t.innerHTML=1,s.appendChild(t)}if(!t.noEvents){const t=e.getEventsForDay(new Date(o,u,1));if(t.length>0){const e=n("div","calendar-date-events");for(let s=0;s<t.length;s++){const r=t[s],i=n("div","calendar-date-event");if(r.ezOfficeIcon){const t=n("img","calendar-date-event-icon");t.src=r.ezOfficeIcon,i.appendChild(t)}const a=n("div","calendar-date-event-label",r.summary);i.appendChild(a),e.appendChild(i)}s.appendChild(e)}}}}E=!1}return t.noStyle||(g.style.gridTemplateRows=f),g}(t,this)}}class o{constructor(t){const e=new Date;this.uid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}(),this.data=t.data||null,this.timestamp=t.timestamp||e.getTime(),this.created=t.created||e.getTime(),this.lastModified=t.lastModified||e.getTime(),this.startTime=t.startTime||e.getTime(),this.endTime=t.endTime||e.getTime(),this.rrule=t.rrule||null,this.summary=t.summary||null,this.description=t.description||null,this.categories=t.categories||[],this.cls=t.cls||null,this.transp=t.transp||null,this.organizer=t.organizer||null,this.geo=t.geo||null,this.status=t.status||null,this.location=t.location||null,this.sequence=t.sequence||null,this.url=t.url||null,this.ezOfficeIcon=t.ezOfficeIcon||null,this.data&&function(t){const e=t.data;if(!e)return;const n=e.split("\n");for(let e=0;e<n.length;e++){const s=n[e];if(!s.startsWith("BEGIN:")&&!s.startsWith("END:"))if(s.startsWith("UID:"))t.uid=s.substring(4);else if(s.startsWith("DTSTAMP:"))t.timestamp=new Date(s.substring(8));else if(s.startsWith("CREATED:"))t.created=new Date(s.substring(8));else if(s.startsWith("LAST-MODIFIED:"))t.lastModified=new Date(s.substring(15));else if(s.startsWith("DTSTART:"))t.startTime=new Date(s.substring(8));else if(s.startsWith("DTEND:"))t.endTime=new Date(s.substring(6));else if(s.startsWith("RRULE:"))t.rrule=new u({data:s.substring(6)});else if(s.startsWith("SUMMARY:"))t.summary=s.substring(8);else if(s.startsWith("DESCRIPTION:"))t.description=s.substring(12);else if(s.startsWith("CATEGORIES:")){const e=s.substring(11).split(","),n=[];for(let t=0;t<e.length;t++){const s=e[t].trim();n.push(s)}t.categories=n}else s.startsWith("CLASS:")?t.cls=s.substring(6):s.startsWith("TRANSP:")?t.transp=s.substring(7):s.startsWith("ORGANIZER:")?t.organizer=s.substring(11):s.startsWith("GEO:")?t.geo=s.substring(4):s.startsWith("STATUS:")?t.status=s.substring(7):s.startsWith("LOCATION:")?t.location=s.substring(9):s.startsWith("SEQUENCE:")?t.sequence=s.substring(9):s.startsWith("URL:")?t.url=s.substring(4):s.startsWith("X-EZOFFICE-ICON:")?t.ezOfficeIcon=s.substring(16):s.startsWith("BEGIN:")||s.startsWith("END:")||s.startsWith("X-")||s.startsWith(" ")||s.startsWith("\t")||s.startsWith(":")||s.startsWith(";")||s.startsWith("#")}}(this)}toIcal(){return h(this)}}class u{constructor(t){this.data=t.data||null,this.freq=t.freq||null,this.interval=t.interval||null,this.count=t.count||null,this.until=t.until||null,this.wkst=t.wkst||null,this.byday=t.byday||null,this.bymonthday=t.bymonthday||null,this.bymonth=t.bymonth||null,this.data&&function(t){const e=t.data;if(!e)return;const n=e.split(";");for(let e=0;e<n.length;e++){const s=n[e];s.startsWith("FREQ:")?t.freq=s.substring(5):s.startsWith("INTERVAL:")?t.interval=s.substring(9):s.startsWith("COUNT:")?t.count=s.substring(6):s.startsWith("UNTIL:")?t.until=s.substring(6):s.startsWith("WKST:")?t.wkst=s.substring(5):s.startsWith("BYDAY:")?t.byday=s.substring(6):s.startsWith("BYMONTHDAY:")?t.bymonthday=s.substring(11):s.startsWith("BYMONTH:")&&(t.bymonth=s.substring(8))}}(this)}toIcal(){return d(this)}}function c(t,e){const n=t.getMonth(),s=t.getFullYear(),r=t.getDate(),i=new Date(e.startTime),l=new Date(e.endTime);if(e.rrule&&e.rrule.freq){if("yearly"==e.rrule.freq){const e=i.getMonth(),n=i.getDate();if(e==t.getMonth()&&n==t.getDate())return!0}if("monthly"==e.rrule.freq){if(e.rrule.bymonthday&&parseInt(e.rrule.bymonthday)>0){let t=a[n];if(1==n&&(s%4==0&&s%100!=0||s%400==0)&&(t=29),t+parseInt(e.rrule.bymonthday)+1==r)return!0}if(i.getDate()==r)return!0}}const o=t.getTime(),u=i.getTime(),c=l.getTime();return o>=u&&o<=c}function d(t){let e="RRULE:";return t.freq&&(e+="FREQ:"+t.freq+";"),t.interval&&(e+="INTERVAL:"+t.interval+";"),t.count&&(e+="COUNT:"+t.count+";"),t.until&&(e+="UNTIL:"+t.until+";"),t.wkst&&(e+="WKST:"+t.wkst+";"),t.byday&&(e+="BYDAY:"+t.byday+";"),t.bymonthday&&(e+="BYMONTHDAY:"+t.bymonthday+";"),t.bymonth&&(e+="BYMONTH:"+t.bymonth+";"),e}function h(t){let e="BEGIN:VEVENT\n";if(e+="UID:"+t.uid+"\n",e+="DTSTAMP:"+t.timestamp.toISOString()+"\n",e+="CREATED:"+t.created.toISOString()+"\n",e+="LAST-MODIFIED:"+t.lastModified.toISOString()+"\n",e+="DTSTART:"+t.startTime.toISOString()+"\n",e+="DTEND:"+t.endTime.toISOString()+"\n",t.rrule&&(e+="RRULE:"+d(t.rrule)+"\n"),t.summary&&(e+="SUMMARY:"+t.summary+"\n"),t.description&&(e+="DESCRIPTION:"+t.description+"\n"),t.categories&&Array.isArray(t.categories)){const n=[];for(let e=0;e<t.categories.length;e++){const s=t.categories[e];n.push(s)}const s=n.join(",");s&&(e+="CATEGORIES:"+s+"\n")}return t.cls&&(e+="CLASS:"+t.cls+"\n"),t.transp&&(e+="TRANSP:"+t.transp+"\n"),t.organizer&&(e+="ORGANIZER:"+t.organizer+"\n"),t.geo&&(e+="GEO:"+t.geo+"\n"),t.status&&(e+="STATUS:"+t.status+"\n"),t.location&&(e+="LOCATION:"+t.location+"\n"),t.sequence&&(e+="SEQUENCE:"+t.sequence+"\n"),t.url&&(e+="URL:"+t.url+"\n"),t.ezOfficeIcon&&(e+="X-EZOFFICE-ICON:"+t.ezOfficeIcon+"\n"),e+="END:VEVENT\n",e}const g={Calendar:l,CalendarEvent:o,RRule:u};var f=e.Vv,y=e.LR,T=e.p3,m=e.Ay;export{f as Calendar,y as CalendarEvent,T as RRule,m as default};